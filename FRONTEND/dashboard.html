<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Medicine Dashboard</title>
    <link rel="stylesheet" href="./output.css">
</head>

<body class="bg-[#007BFF] min-h-screen flex flex-col items-center p-4">

    <!-- Logo top left -->
    <div class="absolute top-4 left-4 w-10 h-10 flex items-center justify-center rounded-full">
        <img src="Images/logo 1.svg" alt="">
    </div>

    <!-- Top Navigation -->
    <div class="flex flex-wrap justify-center gap-3 sm:gap-6 mt-4 bg-[#ffffff]  rounded-full p-1 shadow-md">
        <button class="bg-[#000000] text-[#ffffff]  px-5 py-2 rounded-full font-semibold">
            <a href=""> MY ACTIVITIES</a>
        </button>
        <button class="bg-[#ffffff]  text-[#000000] px-5 py-2 rounded-full font-semibold">
            <a href="./index.html">MY AGENT</a>
        </button>
    </div>

    <!-- Main Content -->
    <div class="grid grid-cols-1 md:grid-cols-3 justify-center content-center gap-6 mt-10 w-full max-w-6xl">

        <!-- My Prescriptions -->
        <div>
            <div class="bg-gray-300 rounded-2xl p-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="bg-[#000000] text-[#ffffff] px-4 py-1 rounded-lg">MY PRESCRIPTIONS</h2>
                </div>

                <!-- Scrollable prescriptions list -->
                <div class="h-[300px] overflow-y-auto space-y-4 pr-2" id="prescriptions-list">
                    <p class="font-mono font-medium" id="no_prescriptions">NO PRESCRIPTIONS ADDED</p>
                </div>

                <!-- Hidden template for prescriptions (outside scrollable list) -->
                <div class="bg-black text-white rounded-2xl p-4 hidden" id="prescription_card">
                    <p class="text-lg font-medium mb-2">
                        <span class="prescription_card_doctor_name">DR ROBERT</span>'S PRESCRIPTION
                    </p>
                    <div class="flex items-center gap-3">
                        <span class="text-lg"><img src="./assets/Vector.svg" alt=""></span>
                        <p class="text-lg prescription_card_hospital">Manipal Hospital</p>
                    </div>
                </div>

                <!-- Add Prescription Button -->
                <div id="addPrescriptionBtn"
                    class="bg-[#000000] rounded-2xl h-[50px] mt-[15px] flex justify-center items-center cursor-pointer">
                    <input type="file" id="imageUpload" accept="image/*" style="display: none;">
                    <div class="text-[#ffffff] flex items-center gap-2">
                        ADD PRESCRIPTION
                        <span><img src="./assets/add_circle.svg" alt="add_button" class="h-[35px]"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Medicines Stock -->
        <div class="bg-gray-200 rounded-lg p-4 flex flex-col h-[400px] overflow-y-scroll">

            <div class="flex justify-between items-center mb-4 ">
                <h2 class="bg-[#000000] text-[#ffffff]  px-4 py-1 rounded-lg">MEDICINES STOCK</h2>
            </div>

            <!-- Container for cloned cards -->
            <div id="cards_container"></div>

            <!-- Template (hidden initially) -->
            <div id="medicine_card_template" class="pt-5 hidden">
                <p class="text-[#ffffff] bg-[#000000] rounded  px-3 py-1 inline-block medicine_name">Atortib</p>
                <p class="text-sm mt-1 medicine_count">10/50</p>
                <div class="w-full bg-[#000000] rounded-full h-2">
                    <div class="bg-green-500 h-2 rounded-full medicine_bar" style="width:20%"></div>
                </div>
            </div>

        </div>



        <!-- Appointments -->
        <div class="bg-gray-200 rounded-lg p-4 flex flex-col h-[400px] overflow-y-scroll ">
            <div class="flex justify-between items-center mb-4">
                <h2 class="bg-[#000000] text-[#ffffff]  px-4 py-1 rounded-lg">APPOINTMENTS </h2>
            </div>

            <!-- main card for the appointments details  -->
            <div id="appointments-list" class="flex flex-col gap-1">

                <p class="font-mono font-medium " id="no_appointments">NO APPOINTMENTS ADDED </p>

                <div id="appointment_card"
                    class="hidden bg-gradient-to-r from-[#ffffff] to-blue-100 p-3 rounded-xl border border-[#000000] m-3">
                    <p class="font-semibold p-1.5">
                        APPOINTMENT WITH: <span class="appointment_card_doctor_name font-mono font-medium">Doctor</span>
                    </p>
                    <p class="flex gap-3">üïí
                        <span class="appointment_card_time font-mono font-medium">Time not specified</span>
                    </p>
                    <p class="font-mono font-medium flex gap-3">üìÖ
                        <span class="appointment_card_date"></span>
                    </p>
                    <p class="text-gray-500 flex gap-3">üìç
                        <span class="appointment_card_hospital font-mono font-medium">Not specified</span>
                    </p>
                </div>
            </div>
        </div>


        <!-- <div id="loader" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
            <div class="bg-white p-6 rounded-lg flex flex-col items-center">
                <div
                    class="loader-spinner border-4 border-t-4 border-gray-200 rounded-full w-12 h-12 animate-spin mb-2">
                </div>
                <p>Processing prescription...</p>
            </div>
        </div> -->

        <!-- the loading animation will be added over here on the top -->


        <!-- Bottom Center Logo -->
        <div class="hidden lg:block fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50">
            <div
                class="mt-8 w-[300px] h-[80px] rounded-2xl bg-gradient-to-r from-red-600 to-black p-4 text-white text-center">
                <div class="font-semibold">UPCOMING MED</div>
                <div>Atortib - 1:30pm</div>
            </div>
        </div>

</body>

<!-- JS Scripts -->
<script type="module" src="./front_end_js/dashboard/appointments/appointmentDetails.js"></script>
<script type="module" src="./front_end_js/dashboard/prescriptions/fetchingPrescriptionDetails.js"></script>
<!-- <script type="module" src="./front_end_js/dashboard/prescriptions/medToTake.js"></script> -->
<script type="module" src="./front_end_js/dashboard/prescriptions/fetchingmedNames.js"></script>

<script type="module">
    import { pushingPrescriptionDataToDB } from "./front_end_js/dashboard/prescriptions/prescriptionParser.js";

    const fileInput = document.getElementById("imageUpload");
    const addBtn = document.getElementById("addPrescriptionBtn");

    addBtn.onclick = () => fileInput.click();

    fileInput.onchange = async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        try {
            await pushingPrescriptionDataToDB(file);
            alert("Prescription uploaded successfully!");
            console.log("Prescription uploaded successfully!");
        } catch (error) {
            console.error("Error uploading prescription:", error);
            alert("Failed to upload prescription. Check console for details.");
        }
    };
</script>

</html>